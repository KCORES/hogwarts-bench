# API 配置验证工具

验证 `.env` 文件中的 API 配置是否能正常工作。

## 功能

- 检查 API 密钥、Base URL、模型名称等配置是否正确
- 发送测试请求验证 API 连通性
- 测量响应时间和输出速度（tokens/s）
- 支持批量验证多个配置文件

## 使用方法

### 验证默认配置

```bash
python -m src.verify_api
```

验证项目根目录下的 `.env` 文件。

### 验证指定配置文件

```bash
python -m src.verify_api .env-kimi
python -m src.verify_api .env-glm
```

### 显示详细输出

```bash
python -m src.verify_api -v
```

使用 `-v` 或 `--verbose` 参数会额外显示 API 的响应内容。

### 批量验证所有配置

```bash
python -m src.verify_api --all
```

验证当前目录下所有 `.env*` 文件（排除 `.env.example`）。

## 参数说明

| 参数 | 描述 |
|------|------|
| `env_file` | 要验证的 .env 文件路径（默认: `.env`） |
| `-v, --verbose` | 显示详细输出，包括 API 响应内容 |
| `--all` | 验证当前目录下所有 .env* 文件 |

## 输出示例

### 单文件验证

```
🔍 验证 API 配置: .env
--------------------------------------------------
📡 Base URL: https://openrouter.ai/api/v1
🤖 Model: anthropic/claude-3-sonnet
🔑 API Key: sk-or-v1...xxxx
--------------------------------------------------
✅ 配置验证通过
📤 发送测试请求...
✅ API 请求成功!
--------------------------------------------------
⏱️  响应时间: 1.23s
📊 输出 Tokens: 45
🚀 输出速度: 36.59 tokens/s
```

### 批量验证

```
找到 3 个配置文件

🔍 验证 API 配置: .env
...

🔍 验证 API 配置: .env-glm
...

🔍 验证 API 配置: .env-kimi
...

==================================================
📊 验证结果汇总:
==================================================
  .env: ✅ 通过 | 36.59 tokens/s
  .env-glm: ✅ 通过 | 42.15 tokens/s
  .env-kimi: ❌ 失败
```

## 常见错误

| 错误信息 | 原因 | 解决方案 |
|----------|------|----------|
| 文件不存在 | 指定的 .env 文件路径错误 | 检查文件路径是否正确 |
| 配置错误 | 缺少必需的配置项 | 确保 `OPENAI_API_KEY` 和 `MODEL_NAME` 已设置 |
| 请求失败 | API 密钥无效或网络问题 | 检查 API 密钥和网络连接 |

## 退出码

- `0`: 验证成功
- `1`: 验证失败
